FROM oven/bun:1.1.13

WORKDIR /app


COPY backend/package.json backend/bun.lock ./
RUN bun install --frozen-lockfile

# Copy source
COPY backend/ ./

# Generate Prisma client (now schema is present)
RUN bun run db:generate

EXPOSE 4000

CMD ["sh", "-c", "bun run db:migrate:deploy && bun index.ts"]

